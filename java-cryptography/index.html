<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="说在前面Java加解密技术是在Java中对密码学的一种实现，但密码学本身是有很多方面的内容。   什么是加解密技术以下是维基上密码学的定义：  Cryptography or cryptology is the practice and study of techniques for secure communication in the presence of third partie">
<meta property="og:type" content="article">
<meta property="og:title" content="Java加解密技术">
<meta property="og:url" content="http://differ-work.github.io/java-cryptography/index.html">
<meta property="og:site_name" content="梦里键指如飞">
<meta property="og:description" content="说在前面Java加解密技术是在Java中对密码学的一种实现，但密码学本身是有很多方面的内容。   什么是加解密技术以下是维基上密码学的定义：  Cryptography or cryptology is the practice and study of techniques for secure communication in the presence of third partie">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-11-09T15:57:43.445Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java加解密技术">
<meta name="twitter:description" content="说在前面Java加解密技术是在Java中对密码学的一种实现，但密码学本身是有很多方面的内容。   什么是加解密技术以下是维基上密码学的定义：  Cryptography or cryptology is the practice and study of techniques for secure communication in the presence of third partie">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://differ-work.github.io/java-cryptography/">





  <title>Java加解密技术 | 梦里键指如飞</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">梦里键指如飞</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">规格严格，功夫到家</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://differ-work.github.io/java-cryptography/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sigh differ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/css/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="梦里键指如飞">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java加解密技术</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-08T00:52:59+08:00">
                2018-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="说在前面"><a href="#说在前面" class="headerlink" title="说在前面"></a>说在前面</h2><p>Java加解密技术是在Java中对密码学的一种实现，但密码学本身是有很多方面的内容。  </p>
<h3 id="什么是加解密技术"><a href="#什么是加解密技术" class="headerlink" title="什么是加解密技术"></a>什么是加解密技术</h3><p>以下是维基上密码学的定义：</p>
<blockquote>
<p>Cryptography or cryptology is the practice and study of techniques for secure communication in the presence of third parties called adversaries. More generally, cryptography is about constructing and analyzing protocols that prevent third parties or the public from reading private messages; various aspects in information security such as data confidentiality, data integrity, authentication, and non-repudiation are central to modern cryptography. Modern cryptography exists at the intersection of the disciplines of mathematics, computer science, electrical engineering, communication science, and physics. Applications of cryptography include electronic commerce, chip-based payment cards, digital currencies, computer passwords, and military communications.</p>
</blockquote>
<blockquote>
<p>密码学是针对信息不被第三方获得的安全传输实践和研究。通常，密码学是关于构造和分析协议，以防止第三方或公众读取私有消息;在信息安全的各个方面，如数据机密性、数据完整性、身份验证和不可否认性，是现代密码学的核心。现代密码学存在于数学、计算机科学、电子工程、通信科学。。。</p>
</blockquote>
<p>以上讲了三点：</p>
<blockquote>
<p>信息<br>传输<br>安全</p>
</blockquote>
<p>简单一句话：密码学就是安全地把信息传给对方(不相关的第三方无法获取你传出去的真实内容)  </p>
<p>密码学有一套丰富的参考模型，里面包含了八大安全机制：</p>
<blockquote>
<ol>
<li>加密机制  </li>
<li>数字签名机制</li>
<li>访问控制机制</li>
<li>数据完整性机制</li>
<li>认证机制  </li>
<li>业务流填充机身</li>
<li>路由控制机制 </li>
<li>公证机制</li>
</ol>
</blockquote>
<p>这里面只讨论加密钥相关的内容(你加密完，我收到后解密成原来的内容)，针对密码学中的其他内容，后续文章再做讨论。</p>
<h3 id="加解密的分类"><a href="#加解密的分类" class="headerlink" title="加解密的分类"></a>加解密的分类</h3><h4 id="按密码体制"><a href="#按密码体制" class="headerlink" title="按密码体制"></a>按密码体制</h4><p>这是一般常说的一种分法，主要是<code>对称密码体制</code>和<code>非对称密码体制</code></p>
<blockquote>
<ol>
<li>对称：加密和解密所用的密钥相同</li>
<li>非对称：加密和密钥所用的不同，密钥分别叫做公钥、私钥。公钥向可以公开，私钥是保密的。</li>
</ol>
</blockquote>
<h4 id="按明文的处理方法"><a href="#按明文的处理方法" class="headerlink" title="按明文的处理方法"></a>按明文的处理方法</h4><p>主要分为<code>分组密码</code>和<code>流密码</code></p>
<blockquote>
<ol>
<li>分组密码：加密的时候把明文分成固定长度的几块，用同一个密钥和算法，将不同的分组块用这同一个密钥和算法进行加密处理。</li>
<li>流密码：加密的时候按位或字节加密明文。</li>
</ol>
</blockquote>
<h2 id="Java对密码学的支持"><a href="#Java对密码学的支持" class="headerlink" title="Java对密码学的支持"></a>Java对密码学的支持</h2><p>主要三方面： 1. java API，2. JavaEE容器， 3. Java工具</p>
<h3 id="Java-API"><a href="#Java-API" class="headerlink" title="Java API"></a>Java API</h3><p>Java中有很多接口和实现类上的支持，如</p>
<blockquote>
<ol>
<li>MessageDigest类，做信息的一个摘要，一般有MD5和SHA</li>
<li>Mac和Cipher两个类， Mac类，构建HMAC加密算法，Cipher可以构建DES、AES、RSA等加密算法</li>
<li>Signature类，用于做数字签名和验证</li>
<li>Certificate类，主要操作证书。</li>
</ol>
</blockquote>
<h3 id="JavaEE容器"><a href="#JavaEE容器" class="headerlink" title="JavaEE容器"></a>JavaEE容器</h3><p>比如Tomcat，只需要简单做一些基本的配置，就可以实现HTTPS的应用。</p>
<h3 id="Java工具"><a href="#Java工具" class="headerlink" title="Java工具"></a>Java工具</h3><p>keytool命令(跟javac等一起在JDK中)可以实现密钥、证书的管理，如生成、导出等。</p>
<h2 id="Java中几种常见加解密的实现"><a href="#Java中几种常见加解密的实现" class="headerlink" title="Java中几种常见加解密的实现"></a>Java中几种常见加解密的实现</h2><h3 id="一些说明"><a href="#一些说明" class="headerlink" title="一些说明"></a>一些说明</h3><p>理论上，密钥的长度是范围比较广的，但由于美国出口的限制(JCE)，一些长度JDK中默认不支持的，如果需要，可以通过替换JRE中JCE(local_policy.jar, US_export_policy.jar 两个文件, 可在<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html" target="_blank" rel="noopener">Oracle官网</a>下载) 来支持其他长度。<br>当然，本地JDK/JRE中的java.security文件中最好也关注一下。</p>
<table>
<thead>
<tr>
<th>算法</th>
<th>理论长度</th>
<th>实际支持长度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DES</td>
<td>值域：{56, 128}</td>
<td>56</td>
<td>JCE限制</td>
</tr>
<tr>
<td>AES</td>
<td>值域：{128, 192, 256}</td>
<td>128</td>
<td>JCE限制</td>
</tr>
<tr>
<td>RSA</td>
<td>区间： [512, 16384]</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="密钥的生成"><a href="#密钥的生成" class="headerlink" title="密钥的生成"></a>密钥的生成</h3><p>主要包括对称加，非对称和椭圆签名算法。<br>以下用到的两个第三方类为:<br><code>org.apache.commons.codec.binary.Base64</code><br><code>org.bouncycastle.jce.provider.BouncyCastleProvider</code>  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生成对称加密密钥</span></span><br><span class="line"><span class="comment">   * algorithm支持 DES, AES两个</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">symmetricKeyGenerator</span><span class="params">(String algorithm, <span class="keyword">int</span> keySize)</span> </span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    Provider provider = <span class="keyword">new</span> BouncyCastleProvider();</span><br><span class="line">    KeyGenerator generator = KeyGenerator.getInstance(algorithm);</span><br><span class="line">    generator.init(keySize);</span><br><span class="line">    SecretKey secretKey = generator.generateKey();</span><br><span class="line">    <span class="keyword">return</span> Base64.encodeBase64String(secretKey.getEncoded());</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生成非对称加密密钥</span></span><br><span class="line"><span class="comment">   * algorithm支持 RSA</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; <span class="title">asymmetricKeyPairGenerator</span><span class="params">(String algorithm, <span class="keyword">int</span> keySize)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);</span><br><span class="line">    keyPairGenerator.initialize(keySize);</span><br><span class="line">    KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class="line">    Map&lt;String, String&gt; keys = <span class="keyword">new</span> HashMap();</span><br><span class="line">    keys.put(<span class="string">"privateKey"</span>, Base64.encodeBase64String(keyPair.getPrivate().getEncoded());</span><br><span class="line">    keys.put(<span class="string">"publicKey"</span>, Base64.encodeBase64String(keyPair.getPublic().getEncoded());</span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生成椭圆验签密钥</span></span><br><span class="line"><span class="comment">   * algorithm支持 ECDSA</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; <span class="title">ecdsaKeyPairGenerator</span><span class="params">(String algorithm, <span class="keyword">int</span> keySize)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Provider provider = <span class="keyword">new</span> BouncyCastleProvider();</span><br><span class="line">    KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm, provider);</span><br><span class="line">    keyPairGenerator.initialize(keySize);</span><br><span class="line">    KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class="line">    Map&lt;String, String&gt; keys = <span class="keyword">new</span> HashMap();</span><br><span class="line">    keys.put(<span class="string">"privateKey"</span>, Base64.encodeBase64String(keyPair.getPrivate().getEncoded());</span><br><span class="line">    keys.put(<span class="string">"publicKey"</span>, Base64.encodeBase64String(keyPair.getPublic().getEncoded());</span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="加密与解密"><a href="#加密与解密" class="headerlink" title="加密与解密"></a>加密与解密</h3><p>DES加密与解密<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">encrypt</span><span class="params">(String data, String key)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> NoSuchPaddingException,</span></span><br><span class="line"><span class="function">              NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">              InvalidKeyException,</span></span><br><span class="line"><span class="function">              BadPaddingException,</span></span><br><span class="line"><span class="function">              IllegalBlockSizeException,</span></span><br><span class="line"><span class="function">              IOException</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">  keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(key);</span><br><span class="line">  Key k = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"DES"</span>);</span><br><span class="line">  Cipher cipher = Cipher.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">  cipher.init(Cipher.ENCRYPT_MODE, k);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> BASE64Encoder().encode(cipher.doFinal(data.getBytes()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">decrypt</span><span class="params">(String data, String key)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> NoSuchPaddingException,</span></span><br><span class="line"><span class="function">                NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">                InvalidKeyException,</span></span><br><span class="line"><span class="function">                BadPaddingException,</span></span><br><span class="line"><span class="function">                IllegalBlockSizeException,</span></span><br><span class="line"><span class="function">                IOException</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">    keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(key);</span><br><span class="line">    Key k = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"DES"</span>);</span><br><span class="line">    Cipher cipher = Cipher.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">    cipher.init(Cipher.DECRYPT_MODE, k);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> String(cipher.doFinal(<span class="keyword">new</span> BASE64Decoder().decodeBuffer(data)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>AES加密与解密<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">encrypt</span><span class="params">(String data, String key)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchPaddingException,</span></span><br><span class="line"><span class="function">            NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">            InvalidKeyException,</span></span><br><span class="line"><span class="function">            BadPaddingException,</span></span><br><span class="line"><span class="function">            IllegalBlockSizeException,</span></span><br><span class="line"><span class="function">            IOException</span>&#123;</span><br><span class="line">              </span><br><span class="line">  <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">  keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(key);</span><br><span class="line">  Key k = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">  Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">  cipher.init(Cipher.ENCRYPT_MODE, k);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> BASE64Encoder().encode(cipher.doFinal(data.getBytes()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String decrypt(String data, String key)</span><br><span class="line">      <span class="keyword">throws</span> NoSuchPaddingException,</span><br><span class="line">              NoSuchAlgorithmException,</span><br><span class="line">              InvalidKeyException,</span><br><span class="line">              BadPaddingException,</span><br><span class="line">              IllegalBlockSizeException,</span><br><span class="line">              IOException&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">  keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(key);</span><br><span class="line">  Key k = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">  Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">  cipher.init(Cipher.DECRYPT_MODE, k);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> String(cipher.doFinal(<span class="keyword">new</span> BASE64Decoder().decodeBuffer(data)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>RSA加密与解密<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">encrypt</span><span class="params">(String body, String keyString)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">        NoSuchPaddingException,</span></span><br><span class="line"><span class="function">        InvalidKeySpecException,</span></span><br><span class="line"><span class="function">        InvalidKeyException,</span></span><br><span class="line"><span class="function">        BadPaddingException,</span></span><br><span class="line"><span class="function">        IllegalBlockSizeException,</span></span><br><span class="line"><span class="function">        IOException</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">    keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(keyString);</span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">    Cipher cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line"></span><br><span class="line">    PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(keyBytes);</span><br><span class="line">    Key key = keyFactory.generatePrivate(keySpec);</span><br><span class="line">    cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BASE64Encoder().encode(cipher.doFinal(body.getBytes()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">decrypt</span><span class="params">(String body, String keyString)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">        NoSuchPaddingException,</span></span><br><span class="line"><span class="function">        InvalidKeySpecException,</span></span><br><span class="line"><span class="function">        InvalidKeyException,</span></span><br><span class="line"><span class="function">        BadPaddingException,</span></span><br><span class="line"><span class="function">        IllegalBlockSizeException,</span></span><br><span class="line"><span class="function">        IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">    keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(keyString);</span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">    Cipher cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line"></span><br><span class="line">    Key key;</span><br><span class="line"></span><br><span class="line">    X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(keyBytes);</span><br><span class="line">    key = keyFactory.generatePublic(keySpec);</span><br><span class="line">    cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">    <span class="keyword">return</span>  <span class="keyword">new</span> String(cipher.doFinal(<span class="keyword">new</span> BASE64Decoder().decodeBuffer(body)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="加签与验签"><a href="#加签与验签" class="headerlink" title="加签与验签"></a>加签与验签</h3><p>RSA加签与验签<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sign</span><span class="params">(String body, String keyString)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchAlgorithmException,</span></span><br><span class="line"><span class="function">        InvalidKeySpecException,</span></span><br><span class="line"><span class="function">        InvalidKeyException,</span></span><br><span class="line"><span class="function">        SignatureException,</span></span><br><span class="line"><span class="function">        IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">byte</span>[] keyBytes;</span><br><span class="line">    keyBytes = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(keyString);</span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">    PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(keyBytes);</span><br><span class="line">    PrivateKey privateKey = keyFactory.generatePrivate(keySpec);</span><br><span class="line"></span><br><span class="line">    Signature signature = Signature.getInstance(<span class="string">"MD5withRSA"</span>);</span><br><span class="line"></span><br><span class="line">    signature.initSign(privateKey);</span><br><span class="line">    signature.update(body.getBytes());</span><br><span class="line">    <span class="keyword">return</span> Base64.encodeBase64String(signature.sign());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String key, String data, String sign)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> NoSuchAlgorithmException, </span></span><br><span class="line"><span class="function">        InvalidKeySpecException, </span></span><br><span class="line"><span class="function">        InvalidKeyException, </span></span><br><span class="line"><span class="function">        SignatureException </span>&#123;</span><br><span class="line"></span><br><span class="line">    X509EncodedKeySpec x509KeySpec = <span class="keyword">new</span> X509EncodedKeySpec(Base64.decodeBase64(key));</span><br><span class="line"></span><br><span class="line">    Provider provider = <span class="keyword">new</span> BouncyCastleProvider();</span><br><span class="line"></span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>, provider);</span><br><span class="line">    PublicKey publicKey = keyFactory.generatePublic(x509KeySpec);</span><br><span class="line">    Signature signature = Signature.getInstance(<span class="string">"MD5withRSA"</span>, provider);</span><br><span class="line"></span><br><span class="line">    signature.initVerify(publicKey);</span><br><span class="line">    signature.update(data.getBytes());</span><br><span class="line">    <span class="keyword">return</span> signature.verify(Base64.decodeBase64(sign));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ECDSA加签与验签<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sign</span><span class="params">(String key, String data)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchAlgorithmException, </span></span><br><span class="line"><span class="function">        InvalidKeySpecException, </span></span><br><span class="line"><span class="function">        InvalidKeyException, </span></span><br><span class="line"><span class="function">        SignatureException </span>&#123;</span><br><span class="line"></span><br><span class="line">    PKCS8EncodedKeySpec pkcs8KeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(Base64.decodeBase64(key));</span><br><span class="line"></span><br><span class="line">    Provider provider = <span class="keyword">new</span> BouncyCastleProvider();</span><br><span class="line"></span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"ECDSA"</span>, provider);</span><br><span class="line">    PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);</span><br><span class="line">    Signature signature = Signature.getInstance(<span class="string">"ECDSA"</span>, provider);</span><br><span class="line"></span><br><span class="line">    signature.initSign(privateKey);</span><br><span class="line">    signature.update(data.getBytes());</span><br><span class="line">    <span class="keyword">return</span> Base64.encodeBase64String(signature.sign());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String key, String data, String sign)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NoSuchAlgorithmException, </span></span><br><span class="line"><span class="function">        InvalidKeySpecException, </span></span><br><span class="line"><span class="function">        InvalidKeyException, </span></span><br><span class="line"><span class="function">        SignatureException </span>&#123;</span><br><span class="line"></span><br><span class="line">    X509EncodedKeySpec x509KeySpec = <span class="keyword">new</span> X509EncodedKeySpec(Base64.decodeBase64(key));</span><br><span class="line"></span><br><span class="line">    Provider provider = <span class="keyword">new</span> BouncyCastleProvider();</span><br><span class="line"></span><br><span class="line">    KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"ECDSA"</span>, provider);</span><br><span class="line">    PublicKey publicKey = keyFactory.generatePublic(x509KeySpec);</span><br><span class="line">    Signature signature = Signature.getInstance(<span class="string">"ECDSA"</span>, provider);</span><br><span class="line"></span><br><span class="line">    signature.initVerify(publicKey);</span><br><span class="line">    signature.update(data.getBytes());</span><br><span class="line">    <span class="keyword">return</span> signature.verify(Base64.decodeBase64(sign));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上代码都在我的github里面 <a href="https://github.com/wangtingbang/cryptography" target="_blank" rel="noopener">wangtingbang/cryptography</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/programing-tool-list/" rel="next" title="编程工具及插件">
                <i class="fa fa-chevron-left"></i> 编程工具及插件
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/java-concurrent-brief/" rel="prev" title="Java并发编程概要">
                Java并发编程概要 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/css/images/avatar.png" alt="sigh differ">
            
              <p class="site-author-name" itemprop="name">sigh differ</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#说在前面"><span class="nav-number">1.</span> <span class="nav-text">说在前面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是加解密技术"><span class="nav-number">1.1.</span> <span class="nav-text">什么是加解密技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加解密的分类"><span class="nav-number">1.2.</span> <span class="nav-text">加解密的分类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#按密码体制"><span class="nav-number">1.2.1.</span> <span class="nav-text">按密码体制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#按明文的处理方法"><span class="nav-number">1.2.2.</span> <span class="nav-text">按明文的处理方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java对密码学的支持"><span class="nav-number">2.</span> <span class="nav-text">Java对密码学的支持</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Java-API"><span class="nav-number">2.1.</span> <span class="nav-text">Java API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaEE容器"><span class="nav-number">2.2.</span> <span class="nav-text">JavaEE容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Java工具"><span class="nav-number">2.3.</span> <span class="nav-text">Java工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java中几种常见加解密的实现"><span class="nav-number">3.</span> <span class="nav-text">Java中几种常见加解密的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一些说明"><span class="nav-number">3.1.</span> <span class="nav-text">一些说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#密钥的生成"><span class="nav-number">3.2.</span> <span class="nav-text">密钥的生成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加密与解密"><span class="nav-number">3.3.</span> <span class="nav-text">加密与解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加签与验签"><span class="nav-number">3.4.</span> <span class="nav-text">加签与验签</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sigh differ</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
